#! /usr/bin/env ruby

require 'optparse'

require 'profig/config'
require 'profig/main'


def parse_args()
	options = {}
	OptionParser.new do |opts|
		opts.banner = 'Usage: profig'

		opts.on('-d', '--directory DIR', 'Select directory') do |d|
			options[:directory] = d
		end
	end.parse!

	return options, ARGV
end

def main()
	opts, args = parse_args()
	p opts
	p args

	dir = opts[:directory]
	dir = '/var/lib/profig/conf.d' if dir.nil?

	config = Profig.load_config(dir)
	Profig.run(config)
end


main()
